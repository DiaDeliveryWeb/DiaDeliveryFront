<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="stylesheet" type="text/css" href="/css/main.css">
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"
            integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.5/dist/js.cookie.min.js"></script>
    <meta charset="UTF-8">
    <title>회원가입 페이지</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nanum+Gothic&family=Nanum+Pen+Script&display=swap');

        html {
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 150%;
            height: 70vh; /* 보는 사람의 페이지의 크기에 따라 변경됨.*/
        }

        body {
            font-family: 'Nanum Pen Script', cursive;
            background-color: rgb(229, 229, 229);
            font-size: 25px;
        }

        #img {
            position: absolute;
            width: 30px;
            height: 30px;
            left: 10px;
            top: 37px;
        }

        #btn {
            width: 450px;
            height: 50px;
            border: 0;
            margin-top: 25px;
            background-color: rgb(0, 212, 212);
            font-size: 25px;
            color: white;
            font-family: 'Nanum Pen Script', cursive;
        }

        #btn:active {
            color: black;
        }

        #link {
            position: absolute;
            right: 25px;
            top: 37px;
            text-decoration-line: none;
            color: rgb(0, 212, 212);
        }

        #link:visited {
            color: rgb(0, 212, 212);
        }

    </style>
    <script>
        const host = 'http://' + window.location.host;
        const otherHost = 'http://localhost:8080';

        function onclickOwner() {
            // Get the checkbox
            var checkBox = document.getElementById("owner-check");
            // Get the output text
            var box = document.getElementById("owner-token");

            // If the checkbox is checked, display the output text
            if (checkBox.checked == true) {
                box.style.display = "block";
            } else {
                box.style.display = "none";
            }
        }

        function signUp() {
            let username = $('#username').val();
            let password = $('#password').val();
            let email = $('#email').val();
            let owner = $('#owner-check').is(':checked');
            let admin = $('#inputCode').val() == "" ? false : true;
            let adminToken = $('#inputCode').val();
            let ownerToken = $('#owner-token').val();

            $.ajax({
                type: "POST",
                url: (otherHost + `/api/user/signup`),
                contentType: "application/json",
                data: JSON.stringify({
                    username: username,
                    password: password,
                    email: email,
                    admin: admin,
                    owner: owner,
                    adminToken: adminToken,
                    ownerToken: ownerToken
                }),
            })
                .done(function (res, status, xhr) {
                    window.location.href = host
                })
                .fail(function (jqXHR, textStatus) {
                    alert("SignUp Fail");
                });
        }
    </script>
</head>
<body>
<div id="signup-form">
    <div id="signup-title">다이아 배달 회원가입</div>

    <div class="signup-desc">
        <input type="text" id="username" placeholder="Username">
    </div>
    <div class="signup-desc">
        <input type="password" id="password" placeholder="Password">
    </div>
    <div class="signup-desc">
        <input type="text" id="email" placeholder="Email">
        <button onclick="sendEmail()"> 인증코드 보내기</button>
    </div>
    <div class="signup-desc">
        <input type="text" id="inputCode" placeholder="AuthCode">
    </div>
    <div class="signup-owner">
        <input id="owner-check" type="checkbox" name="owner" onclick="onclickOwner()" style="margin-top: 40px;">사장님(판매자)
        <input id="owner-token" type="password" name="ownerToken" placeholder="사장님 키" class="login-input-box"
               style="display:none">
    </div>
    <div class="signup-desc">
        <button id="btn" onclick="signUp()">회원가입</button>
    </div>
</div>
</body>
</html>